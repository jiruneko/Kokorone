{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/nagatsukakenji/Kokorone/frontend/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useRef, useEffect } from \"react\";\nimport Image from \"next/image\";\n\ntype ChatMessage = {\n  role: \"user\" | \"assistant\";\n  content: string;\n};\n\nexport default function Page() {\n  const [input, setInput] = useState(\"\");\n  const [messages, setMessages] = useState<ChatMessage[]>([\n    {\n      role: \"assistant\",\n      content:\n        \"こんにちは。Kokoroneです。\\n無理にうまく話そうとしなくて大丈夫。\\n今いちばん重たい気持ちは、どんな感じですか？\",\n    },\n  ]);\n  const [loading, setLoading] = useState(false);\n  const bottomRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, loading]);\n\n  const sendMessage = async () => {\n    if (!input.trim() || loading) return;\n\n    const userText = input;\n    setInput(\"\");\n    setLoading(true);\n\n    setMessages((prev) => [\n      ...prev,\n      { role: \"user\", content: userText },\n    ]);\n\n    try {\n      const res = await fetch(\"/api/chat\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ message: userText }),\n      });\n\n      const data = await res.json();\n\n      setMessages((prev) => [\n        ...prev,\n        {\n          role: \"assistant\",\n          content:\n            data?.reply ??\n            \"ごめんなさい、うまく言葉を返せませんでした。\",\n        },\n      ]);\n    } catch {\n      setMessages((prev) => [\n        ...prev,\n        {\n          role: \"assistant\",\n          content:\n            \"通信エラーが起きました。少し時間を置いてから、また話しかけてください。\",\n        },\n      ]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <main\n      style={{\n        minHeight: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        background: \"#ffffff\",\n        padding: \"24px 12px\",\n      }}\n    >\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: 720,\n          display: \"flex\",\n          flexDirection: \"column\",\n        }}\n      >\n        {/* ロゴ（中央） */}\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"center\",\n            marginBottom: 16,\n          }}\n        >\n          <Image\n            src=\"/Kokorone.png\"\n            alt=\"Kokorone\"\n            width={160}\n            height={160}\n            priority\n            style={{ opacity: 0.95 }}\n          />\n        </div>\n\n        <h1\n          style={{\n            textAlign: \"center\",\n            fontWeight: 500,\n            marginBottom: 4,\n          }}\n        >\n          Kokorone\n        </h1>\n\n        <p\n          style={{\n            textAlign: \"center\",\n            fontSize: 13,\n            color: \"#666\",\n            marginBottom: 20,\n          }}\n        >\n          無理に前向きにならなくて大丈夫。\n          <br />\n          思ったことを、そのまま書いてください。\n        </p>\n\n        {/* チャット履歴 */}\n        <div\n          style={{\n            flex: 1,\n            overflowY: \"auto\",\n            padding: \"8px 4px\",\n          }}\n        >\n          {messages.map((msg, idx) => (\n            <div\n              key={idx}\n              style={{\n                display: \"flex\",\n                justifyContent:\n                  msg.role === \"user\" ? \"flex-end\" : \"flex-start\",\n                marginBottom: 12,\n              }}\n            >\n              <div\n                style={{\n                  maxWidth: \"80%\",\n                  padding: \"12px 14px\",\n                  borderRadius: 12,\n                  background:\n                    msg.role === \"user\" ? \"#222\" : \"#f3f3f3\",\n                  color:\n                    msg.role === \"user\" ? \"#fff\" : \"#000\",\n                  whiteSpace: \"pre-wrap\",\n                  lineHeight: 1.6,\n                  fontSize: 14,\n                }}\n              >\n                {msg.content}\n              </div>\n            </div>\n          ))}\n\n          {loading && (\n            <div style={{ fontSize: 13, color: \"#666\", marginTop: 8 }}>\n              Kokorone が考えています…\n            </div>\n          )}\n\n          <div ref={bottomRef} />\n        </div>\n\n        {/* 入力エリア（Enterでは送信されない） */}\n        <div\n          style={{\n            display: \"flex\",\n            gap: 8,\n            marginTop: 12,\n          }}\n        >\n          <textarea\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            placeholder=\"いまの気持ちを入力してください\"\n            rows={3}\n            style={{\n              flex: 1,\n              padding: 10,\n              borderRadius: 8,\n              border: \"1px solid #ddd\",\n              resize: \"vertical\",\n              fontSize: 14,\n            }}\n          />\n\n          <button\n            onClick={sendMessage}\n            disabled={loading}\n            style={{\n              padding: \"0 16px\",\n              borderRadius: 8,\n              border: \"none\",\n              background: loading ? \"#ccc\" : \"#222\",\n              color: \"#fff\",\n              cursor: loading ? \"default\" : \"pointer\",\n              fontSize: 14,\n            }}\n          >\n            送信\n          </button>\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}